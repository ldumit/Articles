
services:
  submission-api:
    image: ${DOCKER_REGISTRY-}submission-api
    depends_on:
      - sqlserver
      - rabbitmq
    build:
      context: .
      dockerfile: Services/Submission/Submission.API/Dockerfile

  production-api:
    image: ${DOCKER_REGISTRY-}production-api
    depends_on:
      - sqlserver
    build:
      context: .
      dockerfile: Services/Production/Production.API/Dockerfile

  articleHub-api:
    image: ${DOCKER_REGISTRY-}articlehub-api
    depends_on:
      - postgres
      - articlehub-hasura
      - rabbitmq
    build:
      context: .
      dockerfile: Services/ArticleHub/ArticleHub.API/Dockerfile

  journal-api:
    image: ${DOCKER_REGISTRY-}journal-api
    depends_on:
      - journal-redisdb
    build:
      context: .
      dockerfile: Services/Journals/Journals.API/Dockerfile
  
  auth-api:
    image: ${DOCKER_REGISTRY-}auth-api
    depends_on:
      - sqlserver
    build:
      context: .
      dockerfile: Services/Auth/Auth.API/Dockerfile
  
  sqlserver:
    image: mcr.microsoft.com/mssql/server

  journal-redisdb:
    image: redis/redis-stack

  articlehub-hasura:
    image: hasura/graphql-engine
    depends_on:
      - postgres

#talk: separation beetwen main and override files
  postgres:
    image: postgres
    # volumes:
    #   - articlehub_data:/var/lib/postgresql/data/ 

  rabbitmq:
    image: "rabbitmq:management"
    # volumes:
    #   - rabbitmq_data:/var/lib/rabbitmq

volumes:
  articlehub_data:
  rabbitmq_data: