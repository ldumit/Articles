<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="DESCRIPTION" height="593px" preserveAspectRatio="none" style="width:715px;height:593px;background:#FFFFFF;" version="1.1" viewBox="0 0 715 593" width="715px" zoomAndPan="magnify"><title>C4 Level 2 - Authentication + Authorization Flow</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="384.8564" x="161.1099" y="30.9951">C4 Level 2 - Authentication + Authorization Flow</text><!--cluster Auth Service--><g class="cluster" data-entity="Auth Service" data-source-line="12" data-uid="ent0003" id="cluster_Auth Service"><path d="M27.0381,244.7969 L144.5742,244.7969 A3.75,3.75 0 0 1 147.0742,247.2969 L154.0742,283.0938 L248.0381,283.0938 A2.5,2.5 0 0 1 250.5381,285.5938 L250.5381,378.2969 A2.5,2.5 0 0 1 248.0381,380.7969 L27.0381,380.7969 A2.5,2.5 0 0 1 24.5381,378.2969 L24.5381,247.2969 A2.5,2.5 0 0 1 27.0381,244.7969" fill="#F0F8FF" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="24.5381" x2="154.0742" y1="283.0938" y2="283.0938"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="100.5361" x="36.5381" y="267.792">Auth Service</text></g><!--cluster Submission Service--><g class="cluster" data-entity="Submission Service" data-source-line="16" data-uid="ent0005" id="cluster_Submission Service"><path d="M277.0381,244.7969 L447.6211,244.7969 A3.75,3.75 0 0 1 450.1211,247.2969 L457.1211,283.0938 L693.0381,283.0938 A2.5,2.5 0 0 1 695.5381,285.5938 L695.5381,542.2969 A2.5,2.5 0 0 1 693.0381,544.7969 L277.0381,544.7969 A2.5,2.5 0 0 1 274.5381,542.2969 L274.5381,247.2969 A2.5,2.5 0 0 1 277.0381,244.7969" fill="#F9F0FF" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="274.5381" x2="457.1211" y1="283.0938" y2="283.0938"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="153.583" x="286.5381" y="267.792">Submission Service</text></g><!--entity Login--><g class="entity" data-entity="Login" data-source-line="13" data-uid="ent0004" id="entity_Login"><rect fill="#F1F1F1" height="68.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="194.1152" x="40.5381" y="295.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104.7744" x="85.2085" y="326.792">Login Endpoint</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158.1152" x="58.5381" y="343.0889">(Issues JWT with roles)</text></g><!--entity SubAPI--><g class="entity" data-entity="SubAPI" data-source-line="17" data-uid="ent0006" id="entity_SubAPI"><rect fill="#F1F1F1" height="68.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="182.8496" x="291.0381" y="295.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146.8496" x="309.0381" y="326.792">Submission Endpoint</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109.9424" x="327.4917" y="343.0889">(FastEndpoints)</text></g><!--entity AuthZ--><g class="entity" data-entity="AuthZ" data-source-line="18" data-uid="ent0007" id="entity_AuthZ"><rect fill="#F1F1F1" height="68.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="241.1738" x="364.0381" y="459.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="178.8623" x="395.1938" y="490.792">Authorization Middleware</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="205.1738" x="382.0381" y="507.0889">(.NET Identity - Roles/Claims)</text></g><!--entity Client--><g class="entity" data-entity="Client" data-source-line="10" data-uid="ent0002" id="entity_Client"><ellipse cx="259.4932" cy="67.2969" fill="#F1F1F1" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M259.4932,75.2969 L259.4932,102.2969 M246.4932,83.2969 L272.4932,83.2969 M259.4932,102.2969 L246.4932,117.2969 M259.4932,102.2969 L272.4932,117.2969" fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="243.5381" y="139.792">User</text></g><!--link Client to Login--><g class="link" data-entity-1="Client" data-entity-2="Login" data-source-line="22" data-uid="lnk8" id="link_Client_Login"><path d="M235.3981,118.4169 C213.5681,131.1469 182.3381,152.8969 165.5381,180.7969 C144.2981,216.0869 138.8143,257.9515 137.5643,289.6815" fill="none" id="Client-to-Login" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="137.3281,295.6769,141.6793,286.8413,137.5249,290.6808,133.6855,286.5264,137.3281,295.6769" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.4453" x="209.9897" y="201.8638">POST /login</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.3486" x="174.5381" y="216.9966">&#8594; Returns JWT + roles</text></g><!--link Client to SubAPI--><g class="link" data-entity-1="Client" data-entity-2="SubAPI" data-source-line="25" data-uid="lnk9" id="link_Client_SubAPI"><path d="M283.7881,125.5769 C299.5681,139.5669 319.5581,159.5569 332.5381,180.7969 C354.6581,217.0169 367.0189,258.3952 374.3689,289.7552" fill="none" id="Client-to-SubAPI" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="375.7381,295.5969,377.5788,285.9216,374.5971,290.7288,369.7899,287.7471,375.7381,295.5969" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209.8726" x="363.5381" y="209.3638">Authenticated Request with JWT</text></g><!--link SubAPI to AuthZ--><g class="link" data-entity-1="SubAPI" data-entity-2="AuthZ" data-source-line="26" data-uid="lnk10" id="link_SubAPI_AuthZ"><path d="M341.2681,365.1169 C322.8581,384.3869 308.2081,408.7869 322.5381,429.7969 C332.9181,445.0169 342.2813,453.7411 358.5413,462.5411" fill="none" id="SubAPI-to-AuthZ" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="363.8181,465.3969,357.8068,457.5953,359.4208,463.017,353.9991,464.631,363.8181,465.3969" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.7471" x="331.5381" y="417.8638">Validate JWT + Role Claims</text></g><!--link AuthZ to SubAPI--><g class="link" data-entity-1="AuthZ" data-entity-2="SubAPI" data-source-line="27" data-uid="lnk11" id="link_AuthZ_SubAPI"><path d="M512.2681,459.5969 C524.5881,440.3169 533.8381,416.1869 521.5381,396.7969 C510.3181,379.1169 498.268,368.8332 479.518,359.3132" fill="none" id="AuthZ-to-SubAPI" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="474.1681,356.5969,480.3821,364.238,478.6263,358.8605,484.0038,357.1048,474.1681,356.5969" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.8354" x="535.5381" y="417.8638">Access Granted</text></g><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="689.0762" x="9" y="572.792">User logs in via AuthService and accesses protected endpoints using JWT + roles via .NET Identity</text><!--SRC=[PLBDZXCn3BxdAQnoM10gYn27XGDILUsWeWLMRG49beD9t6cqQJ8adfQ2kF80F29FWZqpm5HSHhBd-xETSkjZWnbtODEkIP4Yh_WO239PnbW7CkKlnD46sy1h-iApuEku4pHO-L0UeSeMNJhuMCC6Gndp6tHE-nVcx5yp-4XyR0XIvcqoXZsB_VmnND6U0Zo2ASnQtegBjyW-HRZVDLBsN_kw2kbWB3PTyQPGXf3g0Zx2tcE7NL7UUqk0qG5QIwLGWIOdbY790KNN91-vG5iqtujtQp79AGXA9Hwykbp3mca4FXg3bbE6YJfD00lCWvTVnZHeRx4ccAWb39uJk5Czh2wg2huPW0zNgPPSbuFXJRoxAAKL6xKyUA5rhlS-gcw7DTz7mglsqywNedEEv9-8mI0_0emyAYpyfnoq1JYxNYZbT9SllNE13fX9U2TponsMckry7j3l1XablzU8PtrQsEWj-eN0TFfiw3w5wzUhDPm7hMxYhny_OKdSvbZ6krQLMNUT_sJwkA8pUWfok2LzbkLnlpbHCWDEALqqORp5u9sW1oUT0VeHJ0yvrU_zdsUKL-r-0m00]--></g></svg>